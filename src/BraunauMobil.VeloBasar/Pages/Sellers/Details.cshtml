@page
@model DetailsModel

@{
    ViewData["Title"] = Localizer["Verkäuferin"];
}

<div class="card my-3">
    <div class="card-header d-flex justify-content-between align-items-md-center">
        <div class="mr-auto"><h5>#@Model.Seller.Id @Html.DisplayFor(model => model.Seller.FirstName) @Html.DisplayFor(model => model.Seller.LastName)</h5></div>
        <div class="d-flex justify-content-end">
            <a velo-page="@Model.GetStartAcceptancePage()" class="btn btn-primary mx-1">@Localizer["Artikel annehmen"]</a>
            @if (Model.Products.IsAllowed(TransactionType.Settlement))
            {
                <a velo-age="@Model.GetCreateSettlementPage()" target="_blank" class="btn btn-primary mx-1">@Localizer["Abrechnen"]</a>
            }
            <a velo-page="@Model.GetCreateLabelsPage()" target="_blank" class="btn btn-primary mx-1">@Localizer["Etiketten drucken"]</a>
            <a velo-page="@Model.GetEditPage()" class="btn btn-secondary mx-1">@Localizer["Bearbeiten"]</a>
        </div>

    </div>

    <div class="card-body">
        <div class="row">
            <div class="col">
                <h5 class="card-title">@Localizer["Anschrift"]</h5>
                <p class="card-text">
                    <partial name="/Pages/Sellers/_Address.cshtml" model="@Model.Seller" />
                </p>
                <h5 class="card-title">@Localizer["Bankdaten"]</h5>
                <p class="card-text">
                    @Html.DisplayNameFor(model => model.Seller.IBAN):
                    @Html.DisplayFor(model => model.Seller.IBAN)<br />
                    @Html.DisplayNameFor(model => model.Seller.BIC):
                    @Html.DisplayFor(model => model.Seller.BIC)<br />
                    @Html.DisplayNameFor(model => model.Seller.BankAccountHolder):
                    @Html.DisplayFor(model => model.Seller.BankAccountHolder)<br />
                </p>
            </div>
            <div class="col">
                <ul class="list-group">
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        @Html.DisplayNameFor(model => model.Stats.AceptedProductCount)
                        <span class="badge badge-success badge-pill">@Html.DisplayFor(model => model.Stats.AceptedProductCount)</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        @Html.DisplayNameFor(model => model.Stats.SoldProductCount)
                        <span class="badge badge-success badge-pill">@Html.DisplayFor(model => model.Stats.SoldProductCount)</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        @Html.DisplayNameFor(model => model.Stats.NotSoldProductCount)
                        <span class="badge badge-warning badge-pill">@Html.DisplayFor(model => model.Stats.NotSoldProductCount)</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        @Html.DisplayNameFor(model => model.Stats.PickedUpProductCount)
                        <span class="badge badge-secondary badge-pill">@Html.DisplayFor(model => model.Stats.PickedUpProductCount)</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        @Html.DisplayNameFor(model => model.Stats.SettlementAmout)
                        <span class="badge badge-primary badge-pill">@Html.DisplayFor(model => model.Stats.SettlementAmout)</span>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="card my-3">
    <h5 class="card-header">@Localizer["Artikel"]</h5>
    <div class="card-body p-0">
        @if (Model.Products.Any())
        {
            <partial name="/Pages/Products/_TableWithControls.cshtml" model="@new ListViewModel<Product>(VeloContext.Basar, Model.Products)" />
        }
    </div>
</div>

<div class="card my-3">
    <h5 class="card-header">@Localizer["Annahmen"]</h5>
    <div class="card-body p-0">
        <table Condition="@Model.AcceptanceStatistics.Count > 0" class="table table-striped m-0">
            <thead>
                <tr>
                    <th style="width: auto;" scope="col">@Html.DisplayNameFor(model => model.AcceptanceStatistics[0].Transaction.Number)</th>
                    <th style="width: 80%;" scope="col">@Html.DisplayNameFor(model => model.AcceptanceStatistics[0].Transaction.TimeStamp)</th>
                    <th style="width: 10%;" scope="col">@Html.DisplayNameFor(model => model.AcceptanceStatistics[0].ProductCount)</th>
                    <th style="width: 10%;" scope="col">@Html.DisplayNameFor(model => model.AcceptanceStatistics[0].Amount)</th>
                    <th style="width: auto;" scope="col"></th>
                    <th style="width: auto;" scope="col" Condition="@Model.AcceptanceStatistics[0].Transaction.DocumentId != null"></th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.AcceptanceStatistics)
                {
                    <tr>
                        <th scope="row">@Html.DisplayFor(modelItem => item.Transaction.Number)</th>
                        <td>@Html.DisplayFor(modelItem => item.Transaction.TimeStamp)</td>
                        <td>@Html.DisplayFor(modelItem => item.ProductCount)</td>
                        <td>@Html.DisplayFor(modelItem => item.Amount)</td>
                        <td>
                            <a velo-page="@Model.GetAcceptanceDetailsPage(item)" target="_blank">@Localizer["Details"]</a>
                        </td>
                        <td>
                            <a Condition="@item.Transaction.DocumentId != null" velo-page="@Model.GetDocumentPage(item.Transaction)" target="_blank">@Localizer["Beleg"]</a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<div class="card my-3">
    <h5 class="card-header">@Localizer["Abrechnungen"]</h5>
    <div class="card-body p-0">
        <table Condition="@Model.SettlementStatistics.Count > 0" class="table table-striped m-0">
            <thead>
                <tr>
                    <th style="width: auto;" scope="col">@Html.DisplayNameFor(model => model.SettlementStatistics[0].Transaction.Number)</th>
                    <th style="width: 80%;" scope="col">@Html.DisplayNameFor(model => model.SettlementStatistics[0].Transaction.TimeStamp)</th>
                    <th style="width: 10%;" scope="col">@Html.DisplayNameFor(model => model.SettlementStatistics[0].ProductCount)</th>
                    <th style="width: 10%;" scope="col">@Html.DisplayNameFor(model => model.SettlementStatistics[0].Amount)</th>
                    <th style="width: auto;" scope="col"></th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.SettlementStatistics)
                {
                    <tr>
                        <th scope="row">@Html.DisplayFor(modelItem => item.Transaction.Number)</th>
                        <td>@Html.DisplayFor(modelItem => item.Transaction.TimeStamp)</td>
                        <td>@Html.DisplayFor(modelItem => item.ProductCount)</td>
                        <td>@Html.DisplayFor(modelItem => item.Amount)</td>
                        <td>
                            <a velo-page="@Model.GetDocumentPage(item.Transaction)" target="_blank">@Localizer["Beleg"]</a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>
